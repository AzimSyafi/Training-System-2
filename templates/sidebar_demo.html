<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Collapsible Sidebar Demo</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-+E6J5w96bG8m/6yQeXqVt7hX3Q3YuhGMqeB0mJ0L1p9L2cMyTju8qeV9M7p2j4ycCLlcsoBZp+E6ztJ6vTP2xA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<style>
:root {
  --sidebar-expanded: 200px;
  --sidebar-collapsed: 70px;
  --transition-speed: 0.3s;
  --bg-sidebar: #1e40af;
  --bg-hover: #3b82f6;
  --bg-active: #2563eb; /* Active color for selected item */
  --text-light: #f1f5f9;
  --avatar-size: 46px;
  --icon-size: 20px;
  font-family: system-ui, Arial, sans-serif;
}
* { box-sizing: border-box; }
html, body { height: 100%; margin:0; overflow-x:hidden; background:#f5f7fa; color:#111827; }
.layout { display:flex; min-height:100vh; width:100%; }

/* Sidebar */
.sidebar {
  width: var(--sidebar-expanded);
  background: var(--bg-sidebar);
  color: var(--text-light);
  display: flex;
  flex-direction: column;
  transition: width var(--transition-speed) ease;
  /* --- MODIFICATION: Overflow removed to allow pop-up menu --- */
  /* overflow: hidden; */
}
.sidebar.collapsed { width:var(--sidebar-collapsed); }
.sidebar__inner { flex:1; display:flex; flex-direction:column; min-height:0; }

/* Toggle Button */
.sidebar__toggle {
  background: none;
  border: 0;
  color: var(--text-light);
  font-size: 1.1rem;
  width: 100%;
  height: 54px;
  display: flex;
  align-items: center;
  gap: .75rem;
  padding: 0 1rem;
  cursor: pointer;
  text-align: left;
  /* --- MODIFICATION: Added overflow to clip its own label --- */
  overflow: hidden;
}
.sidebar__toggle:hover { background:var(--bg-hover); }

/* --- MODIFICATION: Toggle centering rule removed to keep it left-aligned --- */
/* .sidebar.collapsed .sidebar__toggle { ... } */

/* Menu */
.menu { list-style:none; margin:0; padding:.5rem 0; flex:0 0 auto; }
.menu-item {
  --pad-x: 1rem;
  display: flex;
  align-items: center;
  gap: .9rem;
  padding: .65rem var(--pad-x);
  color: var(--text-light);
  text-decoration: none;
  line-height: 1;
  position: relative;
  /* --- MODIFICATION: Added overflow to clip its own label --- */
  overflow: hidden;
}
.menu-item.active { background-color: var(--bg-active); }
.menu-item:hover, .menu-item:focus-visible { background:var(--bg-hover); outline:none; }
.menu-item i { min-width:var(--icon-size); font-size:var(--icon-size); text-align:center; }

/* Label animation (hides text) */
.label { display:inline-block; white-space:nowrap; max-width:160px; overflow:hidden; opacity:1; transition:max-width 0.28s ease, opacity 0.2s ease; }
.sidebar.collapsed .label { max-width:0; opacity:0; }

/* Center menu icons when collapsed */
.sidebar.collapsed .menu-item { justify-content:center; padding-left:0; padding-right:0; gap:0; }

/* Spacer */
.sidebar__spacer { flex:1 1 auto; }

/* Profile Section */
.profile {
  display: flex;
  align-items: center;
  gap: .8rem;
  padding: 1rem;
  /* --- MODIFICATION: Position relative for the pop-up menu --- */
  position: relative;
}
.profile__trigger {
  display: flex;
  align-items: center;
  gap: .8rem;
  width: 100%;
  background: none;
  border: 0;
  color: inherit;
  font-family: inherit;
  cursor: pointer;
  border-radius: 6px;
  padding: 4px;
}
.profile__trigger:hover { background: rgba(255, 255, 255, 0.1); }

.profile .avatar { width:var(--avatar-size); height:var(--avatar-size); border-radius:50%; background:#60a5fa; display:flex; align-items:center; justify-content:center; font-weight:600; font-size:1.1rem; overflow:hidden; flex-shrink:0; }
.profile .avatar img { width:100%; height:100%; object-fit:cover; display:block; }
.profile .profile-text {
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

.sidebar.collapsed .profile {
  padding: .75rem 0 .9rem;
  justify-content: center;
}
.sidebar.collapsed .profile__trigger {
  width: auto;
  padding: 4px;
}

/* --- NEW: Profile Pop-up Menu --- */
.profile-menu {
  position: absolute;
  background: #fff;
  color: #111827;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  padding: .5rem 0;
  width: calc(100% - 2rem);
  left: 1rem;
  bottom: calc(100% + .5rem); /* Position above the profile section */
  z-index: 10;
  list-style: none;
  margin: 0;
  opacity: 0;
  visibility: hidden;
  transform: translateY(10px);
  transition: opacity .2s ease, visibility .2s ease, transform .2s ease;
}
.profile.active .profile-menu {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}
/* Position menu to the right when collapsed */
.sidebar.collapsed .profile.active .profile-menu {
  width: 200px; /* Give it a fixed width */
  left: calc(100% + 10px);
  bottom: auto;
  top: 50%;
  transform: translateY(-50%);
}
.profile-menu a {
  display: flex;
  align-items: center;
  gap: .75rem;
  padding: .6rem 1rem;
  text-decoration: none;
  color: inherit;
  font-size: 0.9rem;
}
.profile-menu a:hover { background-color: #f3f4f6; }
.profile-menu a i { width: 16px; text-align: center; }
.profile-menu a.logout { color: #ef4444; }


/* Content */
.content { flex:1; min-width:0; padding:1.5rem 2rem; display:flex; flex-direction:column; }
.content h1 { margin-top:0; }
</style>
</head>
<body>
<div class="layout">
  <aside class="sidebar" id="sidebar" aria-label="Main Sidebar">
    <div class="sidebar__inner">
      <button class="sidebar__toggle" id="sidebarToggle" aria-expanded="true" aria-controls="sidebar" type="button">
        <i class="fas fa-bars"></i><span class="label">Toggle</span>
      </button>
      <nav aria-label="Primary" role="navigation">
        <ul class="menu">
          <li><a href="#" class="menu-item"><i class="fas fa-clock"></i><span class="label">Timesheet</span></a></li>
          <li><a href="#" class="menu-item"><i class="fas fa-user"></i><span class="label">Profile</span></a></li>
          <li><a href="#" class="menu-item"><i class="fas fa-layer-group"></i><span class="label">Modules</span></a></li>
          <li><a href="#" class="menu-item"><i class="fas fa-certificate"></i><span class="label">Badges</span></a></li>
          <li><a href="#" class="menu-item active"><i class="fas fa-building"></i><span class="label">Company</span></a></li>
        </ul>
      </nav>
      <div class="sidebar__spacer"></div>

      <div class="profile" id="profileContainer">
        <button class="profile__trigger" id="profileTrigger" aria-haspopup="true" aria-expanded="false" aria-controls="profileMenu">
          <div class="avatar" aria-hidden="true">
              <img src="https://placehold.co/46x46" alt="User avatar">
          </div>
          <div class="profile-text"><span class="label">test2</span></div>
        </button>
        <ul class="profile-menu" id="profileMenu" role="menu">
            <li role="presentation"><a href="#" role="menuitem"><i class="fas fa-moon"></i> Dark Mode</a></li>
            <li role="presentation"><a href="#" role="menuitem" class="logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
        </ul>
      </div>

    </div>
  </aside>
  <main class="content">
    <h1>Content Area</h1>
    <p>This is example content. Toggle the sidebar and click the profile area to test the new menu.</p>
  </main>
</div>
<script>
(function(){
  // Sidebar toggle
  const sidebar = document.getElementById('sidebar');
  const toggleBtn = document.getElementById('sidebarToggle');
  function updateAria(){ toggleBtn.setAttribute('aria-expanded', !sidebar.classList.contains('collapsed')); }
  toggleBtn.addEventListener('click', () => {
    sidebar.classList.toggle('collapsed');
    updateAria();
  });
  updateAria();

  // --- NEW: Profile menu toggle ---
  const profileContainer = document.getElementById('profileContainer');
  const profileTrigger = document.getElementById('profileTrigger');
  const profileMenu = document.getElementById('profileMenu');

  profileTrigger.addEventListener('click', (event) => {
    event.stopPropagation(); // Prevents the document click listener from firing immediately
    profileContainer.classList.toggle('active');
    const isExpanded = profileContainer.classList.contains('active');
    profileTrigger.setAttribute('aria-expanded', isExpanded);
  });

  // Close menu when clicking outside
  document.addEventListener('click', (event) => {
    if (profileContainer.classList.contains('active') && !profileContainer.contains(event.target)) {
      profileContainer.classList.remove('active');
      profileTrigger.setAttribute('aria-expanded', 'false');
    }
  });

})();
</script>
</body>
</html>