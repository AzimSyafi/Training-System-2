{% extends "base.html" %}

{% block content %}
<script>
  // Force light mode on login page
  (function() {
    document.documentElement.classList.remove('darkmode', 'dark-mode');
    document.body.classList.remove('darkmode', 'dark-mode');
  })();
</script>
<style>
  :root {
    --primary-color: #0d6efd;
    --dark-bg: #071428; /* page background */
    --panel-bg: #ffffff; /* login panel background */
    --light-text: #f8f9fa;
    --dark-text: #212529;
    --body-font: 'Inter', sans-serif;
  }

  /* Dark mode variables - keep form white */
  body.dark-mode,
  html.darkmode body {
    --dark-bg: #0f172a;
    --panel-bg: #ffffff;
    --light-text: #f1f5f9;
    --dark-text: #212529;
  }

  html, body {
    height: 100%;
    margin: 0;
    font-family: var(--body-font);
    background-image: linear-gradient(rgba(7,20,40,0.85), rgba(7,20,40,0.85)), url('https://images.unsplash.com/photo-1550751827-4bd374c3f58b?q=80&w=2070&auto=format&fit=crop');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    background-repeat: no-repeat;
    color: var(--light-text);
    overflow-y: auto;
  }
  
  /* Hide scrollbars but allow scrolling */
  html::-webkit-scrollbar,
  body::-webkit-scrollbar {
    display: none;
  }
  
  html, body {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .login-split-screen {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    align-items: center;
    justify-content: center;
    padding: 20px;
  }

  /* Branding at top */
  .login-brand-panel {
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 20px;
    margin-bottom: 20px;
  }

  .login-brand-panel .brand-logo {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1rem;
    letter-spacing: 1px;
    color: #e6f2ff;
  }

  .login-brand-panel .brand-tagline {
    font-size: 1.25rem;
    font-weight: 400;
    max-width: 400px;
    color: rgba(230,244,255,0.92);
  }

  /* White form panel floating on background */
  .login-form-panel {
    width: 100%;
    max-width: 520px;
    background-color: var(--panel-bg);
    color: var(--dark-text);
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 48px 36px;
    position: relative;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    border-radius: 20px;
  }
  
  /* Hide scrollbar on form panel */
  .login-form-panel::-webkit-scrollbar {
    display: none;
  }
  
  .login-form-panel {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .login-form-wrapper {
    max-width: 420px;
    width: 100%;
    margin: 0 auto;
    background: transparent;
  }

  /* Form Element Styling */
  .login-form-panel .form-label {
    color: #212529 !important;
    font-weight: 500;
    margin-bottom: 8px;
  }

  /* --- NEW --- */
  /* This wrapper is needed for positioning the icon */
  .password-wrapper {
    position: relative;
  }

  /* CHANGED: Targeting by ID for maximum specificity */
  .login-form-panel #email,
  .login-form-panel #password {
    padding: 0.85rem 1rem;
    border-radius: 0.5rem;
    border: 1.5px solid #d1d5db;
    background-color: #ffffff !important; /* Forced white background */
    color: #111827 !important; /* Forced dark text inside */
    font-weight: 400;
    width: 100%; /* Ensure it fills the wrapper */
  }
  
  /* --- MODIFIED --- */
  /* Added padding-right to password field */
  .login-form-panel #password {
      padding-right: 3rem; /* Make space for the icon */
  }

  /* CHANGED: Targeting placeholders by ID */
  .login-form-panel #email::placeholder,
  .login-form-panel #password::placeholder {
    color: #6b7280 !important;
    opacity: 1 !important;
  }

  /* CHANGED: Targeting focus by ID */
  .login-form-panel #email:focus,
  .login-form-panel #password:focus {
    border-color: var(--primary-color);
    background: #ffffff !important; /* Ensure background stays white on focus */
    box-shadow: 0 0 0 3px rgba(13,110,253,0.1);
  }

  .btn-primary {
    padding: 0.85rem 1rem;
    font-weight: 500;
    border-radius: 0.5rem;
  }

  /* --- MODIFIED --- */
  /* Styles for the positioned icon button */
  #togglePassword {
    position: absolute;
    top: 50%;
    right: 1rem; /* Adjust as needed */
    transform: translateY(-50%);
    
    /* Reset button styles */
    background: transparent !important;
    border: none;
    padding: 0;
    margin: 0;
    
    /* Style the icon */
    color: #6b7280;
    cursor: pointer;
    transition: all 0.2s ease;
    
    /* Remove any leftover input-group styles */
    border-radius: 0.5rem; /* Can add a small radius */
    height: auto;
    width: auto;
  }
  
  #togglePassword:hover {
    background: transparent !important;
    color: #111827;
  }
  
  #togglePassword:active {
    background: transparent !important;
    /* Keep vertical centering on transform */
    transform: translateY(-50%) scale(0.95);
  }
  
  #togglePassword i {
    font-size: 1rem;
    /* Ensure icon isn't clipped */
    display: block;
    line-height: 1;
  }

  .login-form-panel .text-muted {
    color: #111827 !important; /* Made this text much darker */
  }

  .login-form-panel h1 {
    color: #111827;
  }

  .login-form-panel a {
    color: var(--primary-color);
  }

  .login-footer-note {
    position: absolute;
    bottom: 1.5rem;
    left: 0;
    right: 0;
    text-align: center;
    color: #6c757d;
    font-size: 0.875rem;
  }

  /* Responsive */
  @media (max-width: 768px) {
    html, body {
      background-attachment: scroll;
    }

    .login-split-screen {
      padding: 15px;
    }

    .login-brand-panel {
      margin-bottom: 15px;
      padding: 15px;
    }

    .login-brand-panel .brand-logo {
      font-size: 1.8rem;
    }

    .login-brand-panel .brand-tagline {
      font-size: 1.1rem;
    }

    .login-form-panel {
      max-width: 100%;
      padding: 30px 24px;
      border-radius: 16px;
    }

    .login-footer-note {
      position: static;
      padding-top: 1.25rem;
    }
  }

  @media (max-width: 480px) {
    .login-form-panel {
      padding: 24px 20px;
    }

    .login-brand-panel .brand-logo {
      font-size: 1.5rem;
    }

    .login-brand-panel .brand-tagline {
      font-size: 1rem;
    }
  }
</style>

<div class="login-split-screen">

  <div class="login-brand-panel">
    <div class="brand-logo">SHAPADU SECURITY</div>
    <p class="brand-tagline">Security Personnel Training Platform</p>
  </div>

  <div class="login-form-panel">
    <div class="login-form-wrapper">

      <div class="text-center mb-4">
        <h1 class="fw-bold" style="font-size: 2.25rem;">Log In</h1>
        <p class="text-muted mt-2">
          Don't have an account?
          <a href="{{ url_for('main.signup') }}" class="fw-bold text-decoration-none">Sign up here</a>
        </p>
      </div>

      <form method="POST">
        <div class="mb-3">
          <label for="email" class="form-label">Email Address</label>
          <input type="email" class="form-control" id="email" name="email" required placeholder="you@example.com">
        </div>
        
        <div class="mb-4">
          <label for="password" class="form-label">Password</label>
          <div class="password-wrapper">
            <input type="password" class="form-control" id="password" name="password" required placeholder="Enter your password">
            <button class="btn" type="button" id="togglePassword" tabindex="-1">
              <i class="fas fa-eye"></i>
            </button>
          </div>
        </div>
        <button type="submit" class="btn btn-primary w-100 fs-5">
          <i class="fas fa-sign-in-alt me-2"></i>Login
        </button>
      </form>

      <div class="text-center mt-4">
          <a href="{{ url_for('main.index') }}" class="btn btn-light border"><i class="fas fa-arrow-left me-2"></i>Back to Home</a>
      </div>
    </div>
    <div class="login-footer-note">
      &copy; 2025 SHAPADU SECURITY SDN BHD. All rights reserved.
    </div>
  </div>

</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Force light mode on login page
    document.documentElement.classList.remove('dark-mode', 'darkmode');
    document.body.classList.remove('dark-mode', 'darkmode');
    
    const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('password');
    if (togglePassword && passwordInput) {
      togglePassword.addEventListener('click', function() {
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
        this.querySelector('i').classList.toggle('fa-eye');
        this.querySelector('i').classList.toggle('fa-eye-slash');
      });
    }
  });
</script>
{% endblock %}