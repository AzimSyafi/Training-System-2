<!-- html -->
{% extends 'base.html' %}

{% block title %}Sign Up - Training System{% endblock %}

{% block content %}
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');

  :root{
    --primary: #0d6efd;
    --bg-dark: #071428;
    --panel-radius: 12px;
  }

  html, body {
    height: 100%;
    margin: 0;
    font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: var(--bg-dark);
    color: #eaf6ff;
  }

  .split-root {
    min-height: 100vh;
    display: flex;
    flex-direction: row;
  }

  /* left panel: background fixed to viewport */
  .left-panel {
    flex: 1.05;
    min-width: 420px;
    min-height: 100vh;
    background-image: linear-gradient(180deg, rgba(6,20,40,0.85) 0%, rgba(8,28,48,0.85) 100%), url('https://images.unsplash.com/photo-1550751827-4bd374c3f58b?q=80&w=2070&auto=format&fit=crop');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;   /* make the image static */
    background-repeat: no-repeat;
    color: #cfe8ff;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    padding: 32px 40px;
  }

  /* brand: fixed so it stays locked to the static image/viewport area */
  .brand {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 520px;               /* confines brand area to left side (matches .right-panel width) */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    gap: 8px;
    pointer-events: none;
    z-index: 2;
    padding: 32px 40px;
  }

  .brand .title {
    font-weight: 800;
    letter-spacing: 1px;
    color: #e6f2ff;
    font-size: 2.25rem;
    line-height: 1;
  }

  .brand .brand-tagline {
    font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    font-size: 2.25rem;
    font-weight: 400;
    color: rgba(230,244,255,0.92);
    line-height: 1.05;
    margin: 0;
  }

  /* Right panel remains white */
  .right-panel {
    width: 520px;
    min-width: 360px;
    background: #ffffff;
    color: #0f1724;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 48px 36px;
    box-shadow: -12px 0 40px rgba(6,20,40,0.06);
  }

  .auth-card {
    width: 100%;
    max-width: 440px;
    border-radius: var(--panel-radius);
    padding: 28px;
    background: transparent;
  }

  .auth-card .card-title {
    font-size: 1.35rem;
    font-weight: 600;
    color: #0f1724;
    margin-bottom: 6px;
  }
  .auth-card .card-sub {
    font-size: 0.95rem;
    color: #6b7280;
    margin-bottom: 18px;
  }

  .form-control {
    border-radius: 8px;
    padding: 10px 12px;
    border: 1px solid #e6edf6;
    background: #fff;
    box-shadow: none;
    color: #0f1724;
  }

  .input-group .btn {
    border-radius: 0 8px 8px 0;
    border: 1px solid #e6edf6;
    background: #fff;
    color: #0f1724;
  }

  .btn-primary-custom {
    background: linear-gradient(90deg, var(--primary) 0%, #0960e6 100%);
    border: none;
    color: #fff;
    padding: 10px 14px;
    border-radius: 10px;
    font-weight: 600;
    width: 100%;
    box-shadow: 0 8px 22px rgba(13,110,253,0.18);
  }

  .muted-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 12px;
    font-size: 0.9rem;
    color: #6b7280;
  }

  .right-footer {
    margin-top: 18px;
    text-align: center;
    font-size: 0.85rem;
    color: #9aa3b2;
  }

  @media (max-width: 1000px) {
    /* revert brand and background behavior on small devices */
    .brand {
      position: relative;
      inset: auto;
      height: auto;
      padding: 28px 0;
      pointer-events: auto;
      transform: none;
      z-index: 1;
    }
    .left-panel { background-attachment: scroll; } /* disable fixed background on small screens */
    .brand .title { font-size: 1.8rem; }
    .brand .brand-tagline { font-size: 1.2rem; }
  }
</style>

<div class="split-root">
  <aside class="left-panel" aria-hidden="true">
    <div class="brand">
      <div class="title">SHAPADU SECURITY</div>
      <p class="brand-tagline">Create your Account</p>
    </div>
  </aside>

  <main class="right-panel">
    <div class="auth-card">
      <div class="card-title">Sign up with email</div>
      <div class="card-sub">Create an account to access security personnel training</div>

      {% with messages = get_flashed_messages() %}
        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <form method="POST" novalidate>
        <div class="mb-3">
          <label for="full_name" class="form-label">Full Name</label>
          <input type="text" class="form-control" id="full_name" name="full_name" required>
        </div>

        <div class="mb-3">
          <label for="email" class="form-label">Email Address</label>
          <input type="email" class="form-control" id="email" name="email" required>
        </div>

        <div class="mb-3">
          <label for="password" class="form-label">Password</label>
          <input type="password" class="form-control" id="password" name="password" required>
        </div>

        <div class="mb-3">
          <label class="form-label">Citizenship</label>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="user_category" id="citizen" value="citizen" required onchange="toggleIdField()">
            <label class="form-check-label" for="citizen">Malaysian Citizen</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="user_category" id="foreigner" value="foreigner" required onchange="toggleIdField()">
            <label class="form-check-label" for="foreigner">Foreigner</label>
          </div>
        </div>

        <div class="mb-3" id="ic_field" style="display: none;">
          <label for="ic_number" class="form-label">IC Number</label>
          <input type="text" class="form-control" id="ic_number" name="ic_number" placeholder="">
        </div>

        <div class="mb-3" id="passport_field" style="display: none;">
          <label for="passport_number" class="form-label">Passport Number</label>
          <input type="text" class="form-control" id="passport_number" name="passport_number" placeholder="">
        </div>

        <div class="mb-3" id="country_field" style="display: none;">
          <label for="country" class="form-label">Country</label>
          <select class="form-select" id="country" name="country">
            <option value="" selected>Select country</option>
            <option>Afghanistan</option>
            <option>Armenia</option>
            <option>Azerbaijan</option>
            <option>Bahrain</option>
            <option>Bangladesh</option>
            <option>Bhutan</option>
            <option>Brunei</option>
            <option>Cambodia</option>
            <option>China</option>
            <option>Cyprus</option>
            <option>Georgia</option>
            <option>Hong Kong SAR</option>
            <option>India</option>
            <option>Indonesia</option>
            <option>Iran</option>
            <option>Iraq</option>
            <option>Japan</option>
            <option>Jordan</option>
            <option>Kazakhstan</option>
            <option>Kuwait</option>
            <option>Kyrgyzstan</option>
            <option>Laos</option>
            <option>Lebanon</option>
            <option>Malaysia</option>
            <option>Maldives</option>
            <option>Mongolia</option>
            <option>Myanmar</option>
            <option>Nepal</option>
            <option>North Korea</option>
            <option>Oman</option>
            <option>Pakistan</option>
            <option>Palestine</option>
            <option>Philippines</option>
            <option>Qatar</option>
            <option>Saudi Arabia</option>
            <option>Singapore</option>
            <option>South Korea</option>
            <option>Sri Lanka</option>
            <option>Syria</option>
            <option>Taiwan</option>
            <option>Tajikistan</option>
            <option>Thailand</option>
            <option>Timor-Leste</option>
            <option>Turkey</option>
            <option>Turkmenistan</option>
            <option>United Arab Emirates</option>
            <option>Uzbekistan</option>
            <option>Vietnam</option>
            <option>Yemen</option>
          </select>
        </div>

        <div class="mb-3">
          <label for="agency_id" class="form-label">Select Agency</label>
          <select class="form-select" id="agency_id" name="agency_id" required>
            <option value="" disabled selected>Select your agency</option>
            {% if agencies %}
              {% for agency in agencies %}
                <option value="{{ agency.agency_id }}">{{ agency.agency_name }}</option>
              {% endfor %}
            {% else %}
              <option disabled>No agencies available</option>
            {% endif %}
          </select>
        </div>

        <div class="d-grid">
          <button type="submit" class="btn btn-primary btn-primary-custom">Create Account</button>
        </div>

        <div class="muted-links" style="margin-top:12px;">
          <div>Already have an account? <a href="{{ url_for('login') }}" class="link-primary">Login</a></div>
          <div><a href="{{ url_for('index') }}" class="text-muted">Back to Home</a></div>
        </div>

        <div class="right-footer">
          <div style="margin-top:8px;">&copy; 2025 SHAPADU SECURITY SDN BHD</div>
        </div>
      </form>
    </div>
  </main>
</div>

<script>
  function toggleIdField() {
    const userCategory = document.querySelector('input[name="user_category"]:checked');
    const icField = document.getElementById('ic_field');
    const passportField = document.getElementById('passport_field');
    const countryField = document.getElementById('country_field');
    const icInput = document.getElementById('ic_number');
    const passportInput = document.getElementById('passport_number');

    if (userCategory) {
      if (userCategory.value === 'citizen') {
        icField.style.display = 'block';
        passportField.style.display = 'none';
        countryField.style.display = 'none';
        if (icInput) icInput.required = true;
        if (passportInput) passportInput.required = false;
      } else if (userCategory.value === 'foreigner') {
        icField.style.display = 'none';
        passportField.style.display = 'block';
        countryField.style.display = 'block';
        if (icInput) icInput.required = false;
        if (passportInput) passportInput.required = true;
      }
    } else {
      icField.style.display = 'none';
      passportField.style.display = 'none';
      countryField.style.display = 'none';
      if (icInput) icInput.required = false;
      if (passportInput) passportInput.required = false;
    }
  }

  window.addEventListener('DOMContentLoaded', toggleIdField);
</script>
{% endblock %}